
name: My-tests-fast-api

on:
  push:
    branches:
      - main

jobs:
  build:
    name: Ubuntu
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: "3.10"
      - uses: abatilo/actions-poetry@v2
        with:
          poetry_version: "1.2.2"
      - name: run-ls
        run: ls -la
      - name: prep-app
        run: |
          poetry update package

  app:
    name: FastApi
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run app
        run: |
          uvicorn fastapi_app.main:app --reload
      - name: run-tests
        run: ./tests/test_api.py

#    steps:
#      - uses: actions/checkout@v2
#
#      - name: run-ls
#        run: ls -la
#
#      - name: run-app
#        run: |
#          uvicorn fastapi_app.main:app --reload
#
#      - name: run-tests
#        run: ./tests/test_api.py


#    strategy:
#      fail-fast: false
#      matrix:
#        python-version: [ "3.6", "3.7", "3.8", "3.9", "3.10" ]
#        poetry-version: [ "1.0", "1.1.15" ]
#        os: [ ubuntu-18.04, macos-latest, windows-latest ]
#      runs-on: ${{ matrix.os }}
#      steps:
#        - uses: actions/checkout@v3
#        - uses: actions/setup-python@v4
#          with:
#            python-version: ${{ matrix.python-version }}
#        - uses: abatilo/actions-poetry@v2
#          with:
#            poetry-version: ${{ matrix.poetry-version }}
